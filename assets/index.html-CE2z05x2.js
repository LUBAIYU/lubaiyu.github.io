import{_ as a,o as l,c as n,d as e,a as s,b as i}from"./app-BYU0ldrB.js";const t={},h=e('<h3 id="nginx" tabindex="-1"><a class="header-anchor" href="#nginx"><span>Nginx</span></a></h3><h4 id="简介" tabindex="-1"><a class="header-anchor" href="#简介"><span>简介</span></a></h4><p>Nginx是什么 =&gt; 高性能的、HTTP和反向代理的Web服务器</p><br><h4 id="核心概念" tabindex="-1"><a class="header-anchor" href="#核心概念"><span>核心概念</span></a></h4><blockquote><p>正向代理</p></blockquote><p>在客户端配置代理服务器，通过代理服务器去访问因特网，这种行为称为正向代理</p><p><img src="https://img2.imgtp.com/2024/04/21/3mN70Jxq.png" alt=""></p><br><h4 id="常用命令" tabindex="-1"><a class="header-anchor" href="#常用命令"><span>常用命令</span></a></h4><p>前提：先进入目录/usr/sbin</p><p>1.查看版本号</p>',12),r=s("div",{class:"language-bash line-numbers-mode","data-ext":"sh","data-title":"sh"},[s("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code","v-pre":""},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"./nginx"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}}," -v")])])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"})])],-1),d=s("br",null,null,-1),k=s("p",null,"2.启动nginx",-1),p=s("div",{class:"language-bash line-numbers-mode","data-ext":"sh","data-title":"sh"},[s("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code","v-pre":""},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"./nginx")])])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"})])],-1),c=s("br",null,null,-1),o=s("p",null,"3.关闭nginx",-1),g=s("div",{class:"language-bash line-numbers-mode","data-ext":"sh","data-title":"sh"},[s("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code","v-pre":""},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"./nginx"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}}," -s"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," stop")])])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"})])],-1),u=s("br",null,null,-1),m=s("p",null,"4.重新加载nginx",-1),A=s("div",{class:"language-bash line-numbers-mode","data-ext":"sh","data-title":"sh"},[s("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code","v-pre":""},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"./nginx"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}}," -s"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," reload")])])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"})])],-1),v=e('<br><h4 id="配置文件" tabindex="-1"><a class="header-anchor" href="#配置文件"><span>配置文件</span></a></h4><p>所在位置：/etc/nginx</p><p>名称：nginx.conf</p><br><p>nginx配置文件主要由三部分组成</p><blockquote><p>全局块</p></blockquote><p>从配置文件开始到events块之间的内容，主要设置一些影响Nginx服务器整体运行的配置指令</p><p>如：<code>worker_processes 1;</code> =&gt; 值越大，Nginx可以支持的并发处理量越大</p><br><blockquote><p>events块</p></blockquote><p>events块涉及的指令主要影响Nginx服务器与用户的网络连接</p><p>如：<code>worker_connections 1024</code> =&gt; 表示支持的最大连接数</p><br><blockquote><p>http块</p></blockquote><p>Nginx服务器中配置最频繁的部分</p><p>可再分为</p><ol><li>http全局块</li><li>server块</li></ol><br><h4 id="常见配置" tabindex="-1"><a class="header-anchor" href="#常见配置"><span>常见配置</span></a></h4><p>1.配置反向代理</p><p>打开nginx.conf文件，在location中添加以下配置</p>',22),b=s("div",{class:"language-bash line-numbers-mode","data-ext":"sh","data-title":"sh"},[s("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code","v-pre":""},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"location"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," /"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"    proxy_pass"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"  IP地址"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},";")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"}")])])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),y=s("br",null,null,-1),_=s("p",null,"2.配置包含指定路径的反向代理",-1),D=s("div",{class:"language-bash line-numbers-mode","data-ext":"sh","data-title":"sh"},[s("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code","v-pre":""},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"location"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," ~"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," /user/"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," {"),s("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"          # 路径包含user则进行转发")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"    proxy_pass"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"  IP地址"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},";"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}}," ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"}")])])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),x=s("br",null,null,-1),C=s("p",null,"3.配置负载均衡",-1),B=s("div",{class:"language-bash line-numbers-mode","data-ext":"sh","data-title":"sh"},[s("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code","v-pre":""},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"upstream"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," myserver"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"    server"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"   ip地址"),s("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"   # 可以是同个IP不同端口")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"    server"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"   ip地址")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"}")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"location"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," /"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"    proxy_pass"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"  http://myserver"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},";"),s("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"    # 这里//后面的名称需与上面对应，可以任意取")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"}")])])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),w=s("br",null,null,-1),E=s("h4",{id:"服务器分配策略",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#服务器分配策略"},[s("span",null,"服务器分配策略")])],-1),f=s("p",null,"1.轮询（默认）",-1),q=s("p",null,"2.weight（权重，默认为1） => 根据每个服务器的权重来分配",-1),N=s("p",null,"配置",-1),P=s("div",{class:"language-bash line-numbers-mode","data-ext":"sh","data-title":"sh"},[s("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code","v-pre":""},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"upstream"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," myserver"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"    server"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"   ip地址"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"  weight="),s("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"1"),s("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"    # 可以是同个IP不同端口")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"    server"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"   ip地址"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"  weight="),s("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"1")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"}")])])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),I=s("p",null,"3.ip_hash => 根据访问IP的hash结果来分配",-1),T=s("p",null,"配置",-1),M=s("div",{class:"language-bash line-numbers-mode","data-ext":"sh","data-title":"sh"},[s("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code","v-pre":""},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"upstream"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," myserver"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"    ip_hash"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},";")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"    server"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"   ip地址"),s("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"   # 可以是同个IP不同端口")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"    server"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"   ip地址"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"  ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"}")])])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),S=s("p",null,"4.fair（第三方）=> 根据后端服务器的响应时间来分配",-1),V=s("p",null,"配置",-1),F=s("div",{class:"language-bash line-numbers-mode","data-ext":"sh","data-title":"sh"},[s("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code","v-pre":""},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"upstream"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," myserver"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"    server"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"   ip地址"),s("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"   # 可以是同个IP不同端口")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"    server"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"   ip地址"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"  ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"    fair"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},";")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"}")])])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),J=e('<br><h4 id="原理" tabindex="-1"><a class="header-anchor" href="#原理"><span>原理</span></a></h4><p>内部实现：master + worker</p><p>master：管理者，只有一个</p><p>worker：实际工作者，有多个</p><br><p>工作机制：</p><p>客户端请求首先到达master，然后master通知worker有请求到达，然后多个worker通过争抢的方式去抢夺请求，抢到的worker则接着执行请求的一系列流程。</p><br><blockquote><p>设置多少个worker合适</p></blockquote><p>worker的数量设置等于CPU数最好</p><br><blockquote><p>一个master + 多个worker 的好处</p></blockquote><p>1.可以使用<code>nginx -s reload</code>热部署，利于nginx进行热部署操作</p><p>2.每个worker是独立的进程，当一个worker出现问题时，其他worker可继续参与争抢，实现请求过程，不会造成服务中断</p><br><blockquote><p>worker支持的最大并发数有多少</p></blockquote><p>1.如果每个请求都是静态请求，不需要访问数据库，则worker支持的最大并发数为 <strong>worker的最大连接数/2</strong></p><p>2.如果每个请求需要访问数据库，则worker支持的最大并发数为 <strong>worker的最大连接数/4</strong></p>',19),L=[h,r,d,k,p,c,o,g,u,m,A,v,b,y,_,D,x,C,B,w,E,f,q,N,P,I,T,M,S,V,F,J];function z(H,O){return l(),n("div",null,L)}const U=a(t,[["render",z],["__file","index.html.vue"]]),W=JSON.parse(`{"path":"/center/uwnnt2ya/","title":"Nginx","lang":"zh-CN","frontmatter":{"title":"Nginx","author":"路白榆","createTime":"2024/04/21 15:11:53","permalink":"/center/uwnnt2ya/","head":[["script",{"id":"check-dark-mode"},";(function () {const um= localStorage.getItem('vuepress-theme-appearance') || 'auto';const sm = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;if (um === 'dark' || (um !== 'light' && sm)) {document.documentElement.classList.add('dark');}})();"],["script",{"id":"check-mac-os"},"document.documentElement.classList.toggle('mac', /Mac|iPhone|iPod|iPad/i.test(navigator.platform))"]]},"headers":[{"level":3,"title":"Nginx","slug":"nginx","link":"#nginx","children":[]}],"readingTime":{"minutes":2.69,"words":806},"git":{"updatedTime":1713684513000,"contributors":[{"name":"user","email":"1296800094@qq.com","commits":1}]},"filePathRelative":"notes/middleware/nginx.md"}`);export{U as comp,W as data};
